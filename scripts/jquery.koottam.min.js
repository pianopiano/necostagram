/* jQuery Plugin Name: Koottam
 * Author Name: Joby Joseph
 * Author Website: www.jobyj.in
 * Copyright 2012, Joby Joseph
 */
(function(a){a.fn.koottam=function(d){var e=a(this);var f=a.extend({id:"jobysblog",service:"facebook",method:"custom",count:0,style:"image_count",theme:"default",count_style:"static",size:"default",cell_color_style:"100",icon_url:""},d);e.css({"text-decoration":"none",position:"relative"});e.html('<span class="social-button-style"></span>');var g=f.cell_color_style.split("");var h=2;if(f.style!="image_count"&&f.style!="logo_count")h=3;for(var i=1;i<=h;i++){if(g[i-1]==0)e.find(".social-button-style").append('<span class="button cell'+i+'"></span>');else e.find(".social-button-style").append('<span class="button '+f.theme+" cell"+i+'"></span>')}if(f.size=="large")e.find(".button").addClass("large");if(f.style=="image_count")e.find(".button:first").addClass("img");e.find(".button:last").html("0");var j="";var k="";var l=0;var m=0;if(f.service=="facebook"){if(f.style=="image_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>')}else if(f.style=="logo_count"){e.find(".button:first").html("Facebook")}else if(f.style=="image_logo_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html("Facebook")}else if(f.style=="image_id_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html("@"+f.id)}if(f.method=="api"){j="https://graph.facebook.com/"+f.id;a.ajax({url:j,dataType:"jsonp",success:function(a){if(f.count_style=="static")b(e,a.likes);else{l=parseInt(a.likes,10);m=Math.round(l/50);c(e,0,m,l)}}})}else if(f.method=="custom"){if(f.count_style=="static")b(e,f.count);else{l=parseInt(f.count,10);m=Math.round(l/50);c(e,0,m,l)}}}else if(f.service=="twitter"){if(f.style=="image_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>')}else if(f.style=="logo_count"){e.find(".button:first").html("Twitter")}else if(f.style=="image_logo_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html("Twitter")}else if(f.style=="image_id_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html("@"+f.id)}if(f.method=="api"){j="https://api.twitter.com/1/users/lookup.json?screen_name="+f.id;a.ajax({url:j,dataType:"jsonp",success:function(a){if(f.count_style=="static")b(e,a[0].followers_count);else{var d=parseInt(a[0].followers_count,10);var g=Math.round(d/50);c(e,0,g,d)}}})}else if(f.method=="custom"){if(f.count_style=="static")b(e,f.count);else{l=parseInt(f.count,10);m=Math.round(l/50);c(e,0,m,l)}}}else{if(f.style=="image_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>')}else if(f.style=="logo_count"){e.find(".button:first").html(f.service)}else if(f.style=="image_logo_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html(f.service)}else if(f.style=="image_id_count"){e.find(".button:first").html('<img src="'+f.icon_url+'"/>');e.find(".button:nth-child(2)").html(f.id)}if(f.method=="api"){alert("API method is not available for this service")}else if(f.method=="custom"){if(f.count_style=="static"){b(e,f.count)}else{l=parseInt(f.count,10);m=Math.round(l/50);c(e,0,m,l)}}}};var b=function(a,b){var c="";b=parseInt(b,10);if(b>1e6){b=b/1e6;b=b.toFixed(1);c=b+" M"}else if(b>1e3){b=b/1e3;b=b.toFixed(1);c=b+" K"}else{c=b}a.find(".button:last").html(c)};var c=function(a,d,e,f){var g=0;if(d+e>=f){g=f;b(a,g)}else{g=d+e;b(a,g);setTimeout(function(){c(a,d+e,e,f)},100)}}})(jQuery)